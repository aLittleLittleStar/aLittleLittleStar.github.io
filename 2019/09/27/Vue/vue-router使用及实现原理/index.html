
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="昨夜小楼又东风">
    <title>vue-router 使用方法及实现原理 - 昨夜小楼又东风</title>
    <meta name="author" content="LittleStar">
    
    
        <link rel="icon" href="http://yoursite.com/assets/images/favicon.ico">
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"LittleStar","sameAs":["https://github.com/aLittleLittleStar","mailto"],"image":"/user-photo/user.jpg"},"articleBody":"\n\n转载： vue-router实现原理前端路由简介以及vue-router实现原理\n路由简介后端路由简介　　路由这个概念最先是后端出现的。在以前用模板引擎开发页面时，经常会看到这样\n\nhttp://www.xxx.com/login\n\n大致流程可以看成这样：　　浏览器发出请求　　服务器监听到80端口（或443）有请求过来，并解析url路径　　根据服务器的路由配置，返回相应信息（可以是 html 字串，也可以是 json 数据，图片等）　　浏览器根据数据包的 Content-Type 来决定如何解析数据\n　　简单来说路由就是用来跟后端服务器进行交互的一种方式，通过不同的路径，来请求不同的资源，请求不同的页面是路由的其中一种功能。\n前端路由1. hash 模式　　随着 ajax 的流行，异步数据请求交互运行在不刷新浏览器的情况下进行。而异步交互体验的更高级版本就是 SPA —— 单页应用。单页应用不仅仅是在页面交互是无刷新的，连页面跳转都是无刷新的，为了实现单页应用，所以就有了前端路由。　　类似于服务端路由，前端路由实现起来其实也很简单，就是匹配不同的 url 路径，进行解析，然后动态的渲染出区域 html 内容。但是这样存在一个问题，就是 url 每次变化的时候，都会造成页面的刷新。那解决问题的思路便是在改变 url 的情况下，保证页面的不刷新。在 2014 年之前，大家是通过 hash 来实现路由，url hash 就是类似于：\n\nhttp://www.xxx.com/#/login\n\n这种#。后面hash值的变化，并不会导致浏览器向服务器发出请求，浏览器不发出请求，也就不会刷新页面。另外每次 hash 值的变化，还会触发hashchange 这个事件，通过这个事件我们就可以知道 hash 值发生了哪些变化。然后我们便可以监听hashchange来实现更新页面部分内容的操作：12345function matchAndUpdate () &#123;   // todo 匹配 hash 做 dom 更新操作&#125;window.addEventListener('hashchange', matchAndUpdate)\n2. history 模式　　14年后，因为HTML5标准发布。多了两个 API，pushState 和 replaceState，通过这两个 API 可以改变 url 地址且不会发送请求。同时还有popstate 事件。通过这些就能用另一种方式来实现前端路由了，但原理都是跟 hash 实现相同的。用了 HTML5 的实现，单页路由的 url 就不会多出一个#，变得更加美观。但因为没有 # 号，所以当用户刷新页面之类的操作时，浏览器还是会给服务器发送请求。为了避免出现这种情况，所以这个实现需要服务器的支持，需要把所有路由都重定向到根页面。12345function matchAndUpdate () &#123;   // todo 匹配路径 做 dom 更新操作&#125;window.addEventListener('popstate', matchAndUpdate)\nVueRouter使用方法路由传参使用router的name属性也就是params来传递参数这个方法有一个bug就是当你传参过去的时候，再次刷新页面时参数就会丢失。解决方法下边会说到。\n　　step:1,首先需要在router/index.js里边配置每个页面的路径，name属性，看例子：1234567891011121314151617181920212223242526272829303132333435363738import Vue from 'vue'import Router from 'vue-router'const _import = require('./_import_' + process.env.NODE_ENV)Vue.use(Router)export const constantRouterMap = [&#123;        path: '/login/:userId/:id',        name:'Message',    //就是要在路由配置里边配置这个属性，用来知道你要跳转到那个页面的名字    /***     * 如果想做到页面刷新，参数不丢失，就必须在path后面加上这个参数     * 但是这样做的话就会导致参数显示在url的后面，（在这一点上）跟query没什么区别了。    *  多个参数也可以一直往后边追加     */        component: _import('login/index'),        hidden: true    &#125;,    &#123;        path: '',        component: Layout,        redirect: 'dashboard',        icon: 'dashboard',        hidden: true,        noDropDown: true,        children: [&#123;            path: 'dashboard',            name: '首页',            component: _import('main/index'),            meta: &#123;                title: 'dashboard',                icon: 'dashboard',                noCache: true            &#125;        &#125;]    &#125;]export default new Router(&#123;    routes: constantRouterMap&#125;)\n　　step:2,在传值页面的写法：//用这种方法传参，必须这么些，不能写path,否则你在取参数的时候this.$router.params.userId就是undefined.这是因为，params只能用name来引入路由，123456this.$router.push(&#123;    name:\"'Message'\",//这个name就是你刚刚配置在router里边的name    params:&#123;          userId:\"10011\"    &#125;&#125;)\n　　step:3,在取值页面的写法：切记，再取参数的时候一定是this.route 不是 this.router，切记。1this.$route.params.userId\n使用query来传递参数　　step:1,在传值页面的写法：123456this.$router.push(&#123;    path:\"/login\",//这个path就是你在router/index.js里边配置的路径    query:&#123;          userId:\"10011\"    &#125;&#125;)\n　　step:2,在取值页面的写法：12345第一种：this.$router.currentRoute.query.userId第二种：这种方法再取参数的时候一定是this.$route   不是   this.$router，切记。this.$route.query.userId\n使用vue里的标签来传递参数　　step:1,在传值页面的写法：123&lt;router-link target=\"_blank\"   :to=\"&#123;path:'/login',query:&#123;userId: \"33333\"&#125;&#125;\"&gt; &lt;/router-link&gt;\n　　step:2,在取值页面的写法：同第二种。其实，router-link也可以使用name的方法传参　　同样，这种方法也需要在router/index.js里边配置每个页面的路径，name属性name:&#39;Message&#39;,    //就是要在路由配置里边配置这个属性，用来知道你要跳转到那个页面的名字&lt;router-link :to=&quot;{name:&#39;&#39;Message&#39;&#39;,params:{userId:&#39;1234&#39;}}&quot;&gt;Hi页面1&lt;/router-link&gt;取参方法：this.$route.params.userId\n核心更新视图但不重新请求页面　　vue-router实现单页面路由跳转，提供了三种方式：hash模式、history模式、abstract模式，根据mode参数来决定采用哪一种方式。\n路由模式vue-router 提供了三种运行模式：　　● hash: 使用 URL hash 值来作路由。默认模式。　　● history: 依赖 HTML5 History API 和服务器配置。查看 HTML5 History 模式。　　● abstract: 支持所有 JavaScript 运行环境，如 Node.js 服务器端\nHash模式　　hash即浏览器url中#后面的内容，包含#。hash是URL中的锚点，代表的是网页中的一个位置，单单改变#后的部分，浏览器只会加载相应位置的内容，不会重新加载页面。也就是说　　1. 即#是用来指导浏览器动作的，对服务器端完全无用，HTTP请求中，不包含#。　　2.每一次改变#后的部分，都会在浏览器的访问历史中增加一个记录，使用”后退”按钮，就可以回到上一个位置。\n所以说Hash模式通过锚点值的改变，根据不同的值，渲染指定DOM位置的不同数据。\nHistory模式　　HTML5 History API提供了一种功能，能让开发人员在不刷新整个页面的情况下修改站点的URL，就是利用 history.pushState API 来完成 URL 跳转而无须重新加载页面；　　由于hash模式会在url中自带#，如果不想要很丑的 hash，我们可以用路由的 history 模式，只需要在配置路由规则时，加入”mode: ‘history‘“,这种模式充分利用 history.pushState API 来完成 URL 跳转而无须重新加载页面。　　有时，history模式下也会出问题：eg:hash模式下：xxx.com/#/id=5 请求地址为 xxx.com,没有问题。history模式下：xxx.com/id=5 请求地址为 xxx.com/id=5，如果后端没有对应的路由处理，就会返回404错误；　　为了应对这种情况，需要后台配置支持：在服务端增加一个覆盖所有情况的候选资源：如果 URL 匹配不到任何静态资源，则应该返回同一个 index.html 页面，这个页面就是你 app 依赖的页面。\nabstract模式　　abstract模式是使用一个不依赖于浏览器的浏览历史虚拟管理后端。根据平台差异可以看出，在 Weex 环境中只支持使用 abstract 模式。 不过，vue-router 自身会对环境做校验，如果发现没有浏览器的 API，vue-router 会自动强制进入 abstract 模式，所以 在使用 vue-router 时只要不写 mode 配置即可，默认会在浏览器环境中使用 hash 模式，在移动端原生环境中使用 abstract 模式。 （当然，你也可以明确指定在所有情况下都使用 abstract 模式）。\n实现原理我们来看一下vue-router是如何定义的：123456789101112import VueRouter from 'vue-router'Vue.use(VueRouter)const router = new VueRouter(&#123;  mode: 'history',  routes: [...]&#125;)new Vue(&#123;  router  ...&#125;)\n　　可以看出来vue-router是通过 Vue.use的方法被注入进 Vue 实例中，在使用的时候我们需要全局用到 vue-router的router-view和router-link组件，以及this.$router/$route这样的实例对象。那么是如何实现这些操作的呢？下面我会分几个章节详细的带你进入vue-router的世界。12345vue-router 实现 -- installvue-router 实现 -- new VueRouter(options)vue-router 实现 -- HashHistoryvue-router 实现 -- HTML5Historyvue-router 实现 -- 路由变更监听\n实现　　经过上面的阐述，相信您已经对前端路由以及vue-router有了一些大致的了解。那么这里我们为了贯彻无解肥，我们来手把手撸一个下面这样的数据驱动的 router：123456789101112131415161718192021222324252627282930313233343536373839404142434445new Router(&#123;  id: 'router-view', // 容器视图  mode: 'hash', // 模式  routes: [    &#123;      path: '/',      name: 'home',      component: '&lt;div&gt;Home&lt;/div&gt;',      beforeEnter: (next) =&gt; &#123;        console.log('before enter home')        next()      &#125;,      afterEnter: (next) =&gt; &#123;        console.log('enter home')        next()      &#125;,      beforeLeave: (next) =&gt; &#123;        console.log('start leave home')        next()      &#125;    &#125;,    &#123;      path: '/bar',      name: 'bar',      component: '&lt;div&gt;Bar&lt;/div&gt;',      beforeEnter: (next) =&gt; &#123;        console.log('before enter bar')        next()      &#125;,      afterEnter: (next) =&gt; &#123;        console.log('enter bar')        next()      &#125;,      beforeLeave: (next) =&gt; &#123;        console.log('start leave bar')        next()      &#125;    &#125;,    &#123;      path: '/foo',      name: 'foo',      component: '&lt;div&gt;Foo&lt;/div&gt;'    &#125;  ]&#125;)\n思路整理　　首先是数据驱动，所以我们可以通过一个route对象来表述当前路由状态，比如：12345678current = &#123;    path: '/', // 路径    query: &#123;&#125;, // query    params: &#123;&#125;, // params    name: '', // 路由名    fullPath: '/', // 完整路径    route: &#123;&#125; // 记录当前路由属性&#125;\n　　current.route内存放当前路由的配置信息，所以我们只需要监听current.route的变化来动态render页面便可。接着我么需要监听不同的路由变化，做相应的处理。以及实现hash和history模式。\n数据驱动　　这里我们延用vue数据驱动模型，实现一个简单的数据劫持，并更新视图。首先定义我们的observer123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293class Observer &#123;  constructor (value) &#123;    this.walk(value)  &#125;  walk (obj) &#123;    Object.keys(obj).forEach((key) =&gt; &#123;      // 如果是对象，则递归调用walk，保证每个属性都可以被defineReactive      if (typeof obj[key] === 'object') &#123;        this.walk(obj[key])      &#125;      defineReactive(obj, key, obj[key])    &#125;)  &#125;&#125;function defineReactive(obj, key, value) &#123;  let dep = new Dep()  Object.defineProperty(obj, key, &#123;    get: () =&gt; &#123;      if (Dep.target) &#123;        // 依赖收集        dep.add()      &#125;      return value    &#125;,    set: (newValue) =&gt; &#123;      value = newValue      // 通知更新，对应的更新视图      dep.notify()    &#125;  &#125;)&#125;export function observer(value) &#123;  return new Observer(value)&#125;再接着，我们需要定义Dep和Watcher:export class Dep &#123;  constructor () &#123;    this.deppend = []  &#125;  add () &#123;    // 收集watcher    this.deppend.push(Dep.target)  &#125;  notify () &#123;    this.deppend.forEach((target) =&gt; &#123;      // 调用watcher的更新函数      target.update()    &#125;)  &#125;&#125;Dep.target = nullexport function setTarget (target) &#123;  Dep.target = target&#125;export function cleanTarget() &#123;  Dep.target = null&#125;// Watcherexport class Watcher &#123;  constructor (vm, expression, callback) &#123;    this.vm = vm    this.callbacks = []    this.expression = expression    this.callbacks.push(callback)    this.value = this.getVal()  &#125;  getVal () &#123;    setTarget(this)    // 触发 get 方法，完成对 watcher 的收集    let val = this.vm    this.expression.split('.').forEach((key) =&gt; &#123;      val = val[key]    &#125;)    cleanTarget()    return val  &#125;  // 更新动作  update () &#123;    this.callbacks.forEach((cb) =&gt; &#123;      cb()    &#125;)  &#125;&#125;\n　　到这里我们实现了一个简单的订阅-发布器，所以我们需要对current.route做数据劫持。一旦current.route更新，我们可以及时的更新当前页面：\n  // 响应式数据劫持  observer(this.current)\n  // 对 current.route 对象进行依赖收集，变化时通过 render 来更新  new Watcher(this.current, &#39;route&#39;, this.render.bind(this))恩….到这里，我们似乎已经完成了一个简单的响应式数据更新。其实render也就是动态的为页面指定区域渲染对应内容，这里只做一个简化版的render:123456render() &#123;  let i  if ((i = this.history.current) &amp;&amp; (i = i.route) &amp;&amp; (i = i.component)) &#123;    document.getElementById(this.container).innerHTML = i  &#125;&#125;\nhash 和 history　　接下来是hash和history模式的实现，这里我们可以沿用vue-router的思想，建立不同的处理模型便可。来看一下我实现的核心代码：this.history = this.mode === &#39;history&#39; ? new HTML5History(this) : new HashHistory(this)当页面变化时，我们只需要监听hashchange和popstate事件，做路由转换transitionTo:12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849  /**   * 路由转换   * @param target 目标路径   * @param cb 成功后的回调   */  transitionTo(target, cb) &#123;    // 通过对比传入的 routes 获取匹配到的 targetRoute 对象    const targetRoute = match(target, this.router.routes)    this.confirmTransition(targetRoute, () =&gt; &#123;      // 这里会触发视图更新      this.current.route = targetRoute      this.current.name = targetRoute.name      this.current.path = targetRoute.path      this.current.query = targetRoute.query || getQuery()      this.current.fullPath = getFullPath(this.current)      cb &amp;&amp; cb()    &#125;)  &#125;  /**   * 确认跳转   * @param route   * @param cb   */  confirmTransition (route, cb) &#123;    // 钩子函数执行队列    let queue = [].concat(      this.router.beforeEach,      this.current.route.beforeLeave,      route.beforeEnter,      route.afterEnter    )        // 通过 step 调度执行    let i = -1    const step = () =&gt; &#123;      i ++      if (i &gt; queue.length) &#123;        cb()      &#125; else if (queue[i]) &#123;        queue[i](step)      &#125; else &#123;        step()      &#125;    &#125;    step(i)  &#125;&#125;\n　　这样我们一方面通过this.current.route = targetRoute达到了对之前劫持数据的更新，来达到视图更新。另一方面我们又通过任务队列的调度，实现了基本的钩子函数beforeEach、beforeLeave、beforeEnter、afterEnter。到这里其实也就差不多了，接下来我们顺带着实现几个API吧：\n123456789101112131415161718192021222324252627282930313233343536373839404142/** * 跳转，添加历史记录 * @param location  * @example this.push(&#123;name: 'home'&#125;) * @example this.push('/') */push (location) &#123;  const targetRoute = match(location, this.router.routes)  this.transitionTo(targetRoute, () =&gt; &#123;    changeUrl(this.router.base, this.current.fullPath)  &#125;)&#125;/** * 跳转，添加历史记录 * @param location * @example this.replaceState(&#123;name: 'home'&#125;) * @example this.replaceState('/') */replaceState(location) &#123;  const targetRoute = match(location, this.router.routes)  this.transitionTo(targetRoute, () =&gt; &#123;    changeUrl(this.router.base, this.current.fullPath, true)  &#125;)&#125;go (n) &#123;  window.history.go(n)&#125;function changeUrl(path, replace) &#123;  const href = window.location.href  const i = href.indexOf('#')  const base = i &gt;= 0 ? href.slice(0, i) : href  if (replace) &#123;    window.history.replaceState(&#123;&#125;, '', `$&#123;base&#125;#/$&#123;path&#125;`)  &#125; else &#123;    window.history.pushState(&#123;&#125;, '', `$&#123;base&#125;#/$&#123;path&#125;`)  &#125;&#125;\n到这里也就基本上结束了\n","dateCreated":"2019-09-27T18:40:21+08:00","dateModified":"2019-09-27T20:01:51+08:00","datePublished":"2019-09-27T18:40:21+08:00","description":"","headline":"vue-router 使用方法及实现原理","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/"},"publisher":{"@type":"Organization","name":"LittleStar","sameAs":["https://github.com/aLittleLittleStar","mailto"],"image":"/user-photo/user.jpg","logo":{"@type":"ImageObject","url":"/user-photo/user.jpg"}},"url":"http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/","keywords":"Vue"}</script>
    <meta name="keywords" content="Vue">
<meta property="og:type" content="blog">
<meta property="og:title" content="vue-router 使用方法及实现原理">
<meta property="og:url" content="http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/index.html">
<meta property="og:site_name" content="昨夜小楼又东风">
<meta property="og:locale" content="zh-cn">
<meta property="og:updated_time" content="2019-09-27T12:01:51.788Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="vue-router 使用方法及实现原理">
    
    
        
    
    
        <meta property="og:image" content="http://yoursite.com/assets/images/user-photo/user.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-du2xmrqdqrl2ollgeiw050kpl6l4nbyz7bumjuurjgsxyopifvukebxc9lqe.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">昨夜小楼又东风</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/user-photo/user.jpg" alt="作者的图片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/user-photo/user.jpg" alt="作者的图片"/>
                </a>
                <h4 class="sidebar-profile-name">LittleStar</h4>
                
                    <h5 class="sidebar-profile-bio"><p>纵豆蔻词工，青楼好梦，难赋深情</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="首页"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="分类"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="标签"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="归档"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="关于"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/aLittleLittleStar" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/mailto"
                            title="邮箱"
                        >
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">邮箱</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            vue-router 使用方法及实现原理
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-09-27T18:40:21+08:00">
	
		    9月 27, 2019
    	
    </time>
    
        <span>发布在 </span>
        
    <a class="category-link" href="/categories/vue-router/">vue-router</a>


    
</div>

    
    <i class="fas fa-chart-area"></i> 
    <span class="post-count">
        字数统计：3.6k字
    </span>
</div>

    

    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h1 id="table-of-contents">目录</h1><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#路由简介"><span class="toc-text">路由简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#后端路由简介"><span class="toc-text">后端路由简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#前端路由"><span class="toc-text">前端路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-hash-模式"><span class="toc-text">1. hash 模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-history-模式"><span class="toc-text">2. history 模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VueRouter"><span class="toc-text">VueRouter</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#使用方法"><span class="toc-text">使用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#路由传参"><span class="toc-text">路由传参</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#使用router的name属性也就是params来传递参数"><span class="toc-text">使用router的name属性也就是params来传递参数</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#使用query来传递参数"><span class="toc-text">使用query来传递参数</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#使用vue里的标签来传递参数"><span class="toc-text">使用vue里的标签来传递参数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#核心"><span class="toc-text">核心</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#路由模式"><span class="toc-text">路由模式</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Hash模式"><span class="toc-text">Hash模式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#History模式"><span class="toc-text">History模式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#abstract模式"><span class="toc-text">abstract模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#实现原理"><span class="toc-text">实现原理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#实现"><span class="toc-text">实现</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#思路整理"><span class="toc-text">思路整理</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#数据驱动"><span class="toc-text">数据驱动</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#hash-和-history"><span class="toc-text">hash 和 history</span></a></li></ol></li></ol></li></ol></li></ol>
<a id="more"></a>
<p>转载： <a href="https://segmentfault.com/a/1190000018584560" target="_blank" rel="noopener">vue-router实现原理</a><br><a href="https://www.cnblogs.com/tiedaweishao/p/9144531.html" target="_blank" rel="noopener">前端路由简介以及vue-router实现原理</a></p>
<h3 id="路由简介"><a href="#路由简介" class="headerlink" title="路由简介"></a>路由简介</h3><h4 id="后端路由简介"><a href="#后端路由简介" class="headerlink" title="后端路由简介"></a>后端路由简介</h4><p>　　路由这个概念最先是后端出现的。在以前用模板引擎开发页面时，经常会看到这样</p>
<blockquote>
<p><a href="http://www.xxx.com/login" target="_blank" rel="noopener">http://www.xxx.com/login</a></p>
</blockquote>
<p>大致流程可以看成这样：<br>　　浏览器发出请求<br>　　服务器监听到80端口（或443）有请求过来，并解析url路径<br>　　根据服务器的路由配置，返回相应信息（可以是 html 字串，也可以是 json 数据，图片等）<br>　　浏览器根据数据包的 Content-Type 来决定如何解析数据</p>
<p>　　简单来说路由就是用来跟后端服务器进行交互的一种方式，通过不同的路径，来请求不同的资源，请求不同的页面是路由的其中一种功能。</p>
<h4 id="前端路由"><a href="#前端路由" class="headerlink" title="前端路由"></a>前端路由</h4><h4 id="1-hash-模式"><a href="#1-hash-模式" class="headerlink" title="1. hash 模式"></a>1. hash 模式</h4><p>　　随着 ajax 的流行，异步数据请求交互运行在不刷新浏览器的情况下进行。而异步交互体验的更高级版本就是 SPA —— 单页应用。单页应用不仅仅是在页面交互是无刷新的，连页面跳转都是无刷新的，为了实现单页应用，所以就有了前端路由。<br>　　类似于服务端路由，前端路由实现起来其实也很简单，就是匹配不同的 url 路径，进行解析，然后动态的渲染出区域 html 内容。但是这样存在一个问题，就是 url 每次变化的时候，都会造成页面的刷新。那解决问题的思路便是在改变 url 的情况下，保证页面的不刷新。在 2014 年之前，大家是通过 hash 来实现路由，url hash 就是类似于：</p>
<blockquote>
<p><a href="http://www.xxx.com/#/login" target="_blank" rel="noopener">http://www.xxx.com/#/login</a></p>
</blockquote>
<p>这种<code>#</code>。后面<code>hash</code>值的变化，并不会导致浏览器向服务器发出请求，浏览器不发出请求，也就不会刷新页面。另外每次 <code>hash</code> 值的变化，还会触发<code>hashchange</code> 这个事件，通过这个事件我们就可以知道 hash 值发生了哪些变化。然后我们便可以监听hashchange来实现更新页面部分内容的操作：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">matchAndUpdate</span></span> () &#123;</span><br><span class="line">   // todo 匹配 <span class="built_in">hash</span> 做 dom 更新操作</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.addEventListener(<span class="string">'hashchange'</span>, matchAndUpdate)</span><br></pre></td></tr></table></figure></p>
<h4 id="2-history-模式"><a href="#2-history-模式" class="headerlink" title="2. history 模式"></a>2. history 模式</h4><p>　　14年后，因为HTML5标准发布。多了两个 API，pushState 和 replaceState，通过这两个 API 可以改变 url 地址且不会发送请求。同时还有popstate 事件。通过这些就能用另一种方式来实现前端路由了，但原理都是跟 hash 实现相同的。用了 HTML5 的实现，单页路由的 url 就不会多出一个#，变得更加美观。但因为没有 # 号，所以当用户刷新页面之类的操作时，浏览器还是会给服务器发送请求。为了避免出现这种情况，所以这个实现需要服务器的支持，需要把所有路由都重定向到根页面。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">matchAndUpdate</span></span> () &#123;</span><br><span class="line">   // todo 匹配路径 做 dom 更新操作</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.addEventListener(<span class="string">'popstate'</span>, matchAndUpdate)</span><br></pre></td></tr></table></figure></p>
<h3 id="VueRouter"><a href="#VueRouter" class="headerlink" title="VueRouter"></a>VueRouter</h3><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><h5 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h5><h6 id="使用router的name属性也就是params来传递参数"><a href="#使用router的name属性也就是params来传递参数" class="headerlink" title="使用router的name属性也就是params来传递参数"></a>使用router的name属性也就是params来传递参数</h6><p>这个方法有一个bug就是当你传参过去的时候，再次刷新页面时参数就会丢失。解决方法下边会说到。</p>
<p>　　step:1,首先需要在router/index.js里边配置每个页面的路径，name属性，看例子：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import Vue from <span class="string">'vue'</span></span><br><span class="line">import Router from <span class="string">'vue-router'</span></span><br><span class="line">const _import = require(<span class="string">'./_import_'</span> + process.env.NODE_ENV)</span><br><span class="line">Vue.use(Router)</span><br><span class="line"><span class="built_in">export</span> const constantRouterMap = [&#123;</span><br><span class="line">        path: <span class="string">'/login/:userId/:id'</span>,</span><br><span class="line">        name:<span class="string">'Message'</span>,    //就是要在路由配置里边配置这个属性，用来知道你要跳转到那个页面的名字</span><br><span class="line">    /***</span><br><span class="line">     * 如果想做到页面刷新，参数不丢失，就必须在path后面加上这个参数</span><br><span class="line">     * 但是这样做的话就会导致参数显示在url的后面，（在这一点上）跟query没什么区别了。</span><br><span class="line">    *  多个参数也可以一直往后边追加</span><br><span class="line">     */</span><br><span class="line">        component: _import(<span class="string">'login/index'</span>),</span><br><span class="line">        hidden: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        path: <span class="string">''</span>,</span><br><span class="line">        component: Layout,</span><br><span class="line">        redirect: <span class="string">'dashboard'</span>,</span><br><span class="line">        icon: <span class="string">'dashboard'</span>,</span><br><span class="line">        hidden: <span class="literal">true</span>,</span><br><span class="line">        noDropDown: <span class="literal">true</span>,</span><br><span class="line">        children: [&#123;</span><br><span class="line">            path: <span class="string">'dashboard'</span>,</span><br><span class="line">            name: <span class="string">'首页'</span>,</span><br><span class="line">            component: _import(<span class="string">'main/index'</span>),</span><br><span class="line">            meta: &#123;</span><br><span class="line">                title: <span class="string">'dashboard'</span>,</span><br><span class="line">                icon: <span class="string">'dashboard'</span>,</span><br><span class="line">                noCache: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> default new Router(&#123;</span><br><span class="line">    routes: constantRouterMap</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>　　step:2,在传值页面的写法：<br>//用这种方法传参，必须这么些，不能写path,否则你在取参数的时候this.$router.params.userId就是undefined.这是因为，params只能用name来引入路由，<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">this.<span class="variable">$router</span>.push(&#123;</span><br><span class="line">    name:<span class="string">"'Message'"</span>,//这个name就是你刚刚配置在router里边的name</span><br><span class="line">    params:&#123;</span><br><span class="line">          userId:<span class="string">"10011"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>　　step:3,在取值页面的写法：<br>切记，再取参数的时候一定是this.route 不是 this.router，切记。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$route.params.userId</span><br></pre></td></tr></table></figure></p>
<h6 id="使用query来传递参数"><a href="#使用query来传递参数" class="headerlink" title="使用query来传递参数"></a>使用query来传递参数</h6><p>　　step:1,在传值页面的写法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">this.<span class="variable">$router</span>.push(&#123;</span><br><span class="line">    path:<span class="string">"/login"</span>,//这个path就是你在router/index.js里边配置的路径</span><br><span class="line">    query:&#123;</span><br><span class="line">          userId:<span class="string">"10011"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>　　step:2,在取值页面的写法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">第一种：</span><br><span class="line">this.<span class="variable">$router</span>.currentRoute.query.userId</span><br><span class="line">第二种：</span><br><span class="line">这种方法再取参数的时候一定是this.<span class="variable">$route</span>   不是   this.<span class="variable">$router</span>，切记。</span><br><span class="line">this.<span class="variable">$route</span>.query.userId</span><br></pre></td></tr></table></figure></p>
<h6 id="使用vue里的标签来传递参数"><a href="#使用vue里的标签来传递参数" class="headerlink" title="使用vue里的标签来传递参数"></a>使用vue里的<router-link>标签来传递参数</router-link></h6><p>　　step:1,在传值页面的写法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link target=<span class="string">"_blank"</span></span><br><span class="line">   :to=<span class="string">"&#123;path:'/login',query:&#123;userId: "</span>33333<span class="string">"&#125;&#125;"</span>&gt;</span><br><span class="line"> &lt;/router-link&gt;</span><br></pre></td></tr></table></figure></p>
<p>　　step:2,在取值页面的写法：同第二种。<br>其实，router-link也可以使用name的方法传参<br>　　同样，这种方法也需要在<code>router/index.js</code>里边配置每个页面的路径，name属性<br><code>name:&#39;Message&#39;</code>,    //就是要在路由配置里边配置这个属性，用来知道你要跳转到那个页面的名字<br><code>&lt;router-link :to=&quot;{name:&#39;&#39;Message&#39;&#39;,params:{userId:&#39;1234&#39;}}&quot;&gt;Hi页面1&lt;/router-link&gt;</code><br>取参方法：<br><code>this.$route.params.userId</code></p>
<h4 id="核心"><a href="#核心" class="headerlink" title="核心"></a>核心</h4><p><code>更新视图但不重新请求页面</code><br>　　vue-router实现单页面路由跳转，提供了三种方式：hash模式、history模式、abstract模式，根据mode参数来决定采用哪一种方式。</p>
<h5 id="路由模式"><a href="#路由模式" class="headerlink" title="路由模式"></a>路由模式</h5><p>vue-router 提供了三种运行模式：<br>　　● hash: 使用 URL hash 值来作路由。默认模式。<br>　　● history: 依赖 HTML5 History API 和服务器配置。查看 HTML5 History 模式。<br>　　● abstract: 支持所有 JavaScript 运行环境，如 Node.js 服务器端</p>
<h6 id="Hash模式"><a href="#Hash模式" class="headerlink" title="Hash模式"></a>Hash模式</h6><p>　　hash即浏览器url中#后面的内容，包含#。hash是URL中的锚点，代表的是网页中的一个位置，单单改变#后的部分，浏览器只会加载相应位置的内容，不会重新加载页面。<br>也就是说<br>　　1. 即#是用来指导浏览器动作的，对服务器端完全无用，HTTP请求中，不包含#。<br>　　2.每一次改变#后的部分，都会在浏览器的访问历史中增加一个记录，使用”后退”按钮，就可以回到上一个位置。</p>
<p>所以说Hash模式通过锚点值的改变，根据不同的值，渲染指定DOM位置的不同数据。</p>
<h6 id="History模式"><a href="#History模式" class="headerlink" title="History模式"></a>History模式</h6><p>　　<code>HTML5 History API</code>提供了一种功能，能让开发人员在不刷新整个页面的情况下修改站点的URL，就是利用 <code>history.pushState API</code> 来完成 URL 跳转而无须重新加载页面；<br>　　由于hash模式会在url中自带#，如果不想要很丑的 <code>hash</code>，我们可以用路由的 <code>history</code> 模式，只需要在配置路由规则时，加入”<code>mode</code>: ‘<code>history</code>‘“,这种模式充分利用 <code>history.pushState API</code> 来完成 <code>URL</code> 跳转而无须重新加载页面。<br>　　有时，history模式下也会出问题：<br>eg:<br>hash模式下：<code>xxx.com/#/id=5</code> 请求地址为 <code>xxx.com</code>,没有问题。<br>history模式下：<code>xxx.com/id=5</code> 请求地址为 <code>xxx.com/id=5</code>，如果后端没有对应的路由处理，就会返回404错误；<br>　　为了应对这种情况，需要后台配置支持：<br>在服务端增加一个覆盖所有情况的候选资源：如果 URL 匹配不到任何静态资源，则应该返回同一个 <code>index.html</code> 页面，这个页面就是你 app 依赖的页面。</p>
<h6 id="abstract模式"><a href="#abstract模式" class="headerlink" title="abstract模式"></a>abstract模式</h6><p>　　abstract模式是使用一个不依赖于浏览器的浏览历史虚拟管理后端。<br>根据平台差异可以看出，在 Weex 环境中只支持使用 abstract 模式。 不过，vue-router 自身会对环境做校验，如果发现没有浏览器的 API，vue-router 会自动强制进入 abstract 模式，所以 在使用 vue-router 时只要不写 mode 配置即可，默认会在浏览器环境中使用 hash 模式，在移动端原生环境中使用 abstract 模式。 （当然，你也可以明确指定在所有情况下都使用 abstract 模式）。</p>
<h4 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h4><p>我们来看一下<code>vue-router</code>是如何定义的：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import VueRouter from <span class="string">'vue-router'</span></span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line"></span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  mode: <span class="string">'history'</span>,</span><br><span class="line">  routes: [...]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">new Vue(&#123;</span><br><span class="line">  router</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>　　可以看出来vue-router是通过 Vue.use的方法被注入进 Vue 实例中，在使用的时候我们需要全局用到 vue-router的router-view和router-link组件，以及this.$router/$route这样的实例对象。那么是如何实现这些操作的呢？下面我会分几个章节详细的带你进入vue-router的世界。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vue-router 实现 -- install</span><br><span class="line">vue-router 实现 -- new VueRouter(options)</span><br><span class="line">vue-router 实现 -- HashHistory</span><br><span class="line">vue-router 实现 -- HTML5History</span><br><span class="line">vue-router 实现 -- 路由变更监听</span><br></pre></td></tr></table></figure></p>
<h5 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h5><p>　　经过上面的阐述，相信您已经对前端路由以及vue-router有了一些大致的了解。那么这里我们为了贯彻无解肥，我们来手把手撸一个下面这样的数据驱动的 router：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">new Router(&#123;</span><br><span class="line">  id: <span class="string">'router-view'</span>, // 容器视图</span><br><span class="line">  mode: <span class="string">'hash'</span>, // 模式</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">      name: <span class="string">'home'</span>,</span><br><span class="line">      component: <span class="string">'&lt;div&gt;Home&lt;/div&gt;'</span>,</span><br><span class="line">      beforeEnter: (next) =&gt; &#123;</span><br><span class="line">        console.log(<span class="string">'before enter home'</span>)</span><br><span class="line">        next()</span><br><span class="line">      &#125;,</span><br><span class="line">      afterEnter: (next) =&gt; &#123;</span><br><span class="line">        console.log(<span class="string">'enter home'</span>)</span><br><span class="line">        next()</span><br><span class="line">      &#125;,</span><br><span class="line">      beforeLeave: (next) =&gt; &#123;</span><br><span class="line">        console.log(<span class="string">'start leave home'</span>)</span><br><span class="line">        next()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/bar'</span>,</span><br><span class="line">      name: <span class="string">'bar'</span>,</span><br><span class="line">      component: <span class="string">'&lt;div&gt;Bar&lt;/div&gt;'</span>,</span><br><span class="line">      beforeEnter: (next) =&gt; &#123;</span><br><span class="line">        console.log(<span class="string">'before enter bar'</span>)</span><br><span class="line">        next()</span><br><span class="line">      &#125;,</span><br><span class="line">      afterEnter: (next) =&gt; &#123;</span><br><span class="line">        console.log(<span class="string">'enter bar'</span>)</span><br><span class="line">        next()</span><br><span class="line">      &#125;,</span><br><span class="line">      beforeLeave: (next) =&gt; &#123;</span><br><span class="line">        console.log(<span class="string">'start leave bar'</span>)</span><br><span class="line">        next()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/foo'</span>,</span><br><span class="line">      name: <span class="string">'foo'</span>,</span><br><span class="line">      component: <span class="string">'&lt;div&gt;Foo&lt;/div&gt;'</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h6 id="思路整理"><a href="#思路整理" class="headerlink" title="思路整理"></a>思路整理</h6><p>　　首先是数据驱动，所以我们可以通过一个route对象来表述当前路由状态，比如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">current = &#123;</span><br><span class="line">    path: <span class="string">'/'</span>, // 路径</span><br><span class="line">    query: &#123;&#125;, // query</span><br><span class="line">    params: &#123;&#125;, // params</span><br><span class="line">    name: <span class="string">''</span>, // 路由名</span><br><span class="line">    fullPath: <span class="string">'/'</span>, // 完整路径</span><br><span class="line">    route: &#123;&#125; // 记录当前路由属性</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　current.route内存放当前路由的配置信息，所以我们只需要监听current.route的变化来动态render页面便可。<br>接着我么需要监听不同的路由变化，做相应的处理。以及实现hash和history模式。</p>
<h6 id="数据驱动"><a href="#数据驱动" class="headerlink" title="数据驱动"></a>数据驱动</h6><p>　　这里我们延用vue数据驱动模型，实现一个简单的数据劫持，并更新视图。首先定义我们的observer<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">class Observer &#123;</span><br><span class="line">  constructor (value) &#123;</span><br><span class="line">    this.walk(value)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  walk (obj) &#123;</span><br><span class="line">    Object.keys(obj).forEach((key) =&gt; &#123;</span><br><span class="line">      // 如果是对象，则递归调用walk，保证每个属性都可以被defineReactive</span><br><span class="line">      <span class="keyword">if</span> (typeof obj[key] === <span class="string">'object'</span>) &#123;</span><br><span class="line">        this.walk(obj[key])</span><br><span class="line">      &#125;</span><br><span class="line">      defineReactive(obj, key, obj[key])</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> defineReactive(obj, key, value) &#123;</span><br><span class="line">  <span class="built_in">let</span> dep = new Dep()</span><br><span class="line">  Object.defineProperty(obj, key, &#123;</span><br><span class="line">    get: () =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (Dep.target) &#123;</span><br><span class="line">        // 依赖收集</span><br><span class="line">        dep.add()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">return</span> value</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">set</span>: (newValue) =&gt; &#123;</span><br><span class="line">      value = newValue</span><br><span class="line">      // 通知更新，对应的更新视图</span><br><span class="line">      dep.notify()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> <span class="keyword">function</span> observer(value) &#123;</span><br><span class="line">  <span class="built_in">return</span> new Observer(value)</span><br><span class="line">&#125;</span><br><span class="line">再接着，我们需要定义Dep和Watcher:</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> class Dep &#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span></span> () &#123;</span><br><span class="line">    this.deppend = []</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">add</span></span> () &#123;</span><br><span class="line">    // 收集watcher</span><br><span class="line">    this.deppend.push(Dep.target)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">notify</span></span> () &#123;</span><br><span class="line">    this.deppend.forEach((target) =&gt; &#123;</span><br><span class="line">      // 调用watcher的更新函数</span><br><span class="line">      target.update()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dep.target = null</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> <span class="keyword">function</span> setTarget (target) &#123;</span><br><span class="line">  Dep.target = target</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> <span class="keyword">function</span> <span class="function"><span class="title">cleanTarget</span></span>() &#123;</span><br><span class="line">  Dep.target = null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Watcher</span><br><span class="line"><span class="built_in">export</span> class Watcher &#123;</span><br><span class="line">  constructor (vm, expression, callback) &#123;</span><br><span class="line">    this.vm = vm</span><br><span class="line">    this.callbacks = []</span><br><span class="line">    this.expression = expression</span><br><span class="line">    this.callbacks.push(callback)</span><br><span class="line">    this.value = this.getVal()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">getVal</span></span> () &#123;</span><br><span class="line">    setTarget(this)</span><br><span class="line">    // 触发 get 方法，完成对 watcher 的收集</span><br><span class="line">    <span class="built_in">let</span> val = this.vm</span><br><span class="line">    this.expression.split(<span class="string">'.'</span>).forEach((key) =&gt; &#123;</span><br><span class="line">      val = val[key]</span><br><span class="line">    &#125;)</span><br><span class="line">    cleanTarget()</span><br><span class="line">    <span class="built_in">return</span> val</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 更新动作</span><br><span class="line">  <span class="function"><span class="title">update</span></span> () &#123;</span><br><span class="line">    this.callbacks.forEach((cb) =&gt; &#123;</span><br><span class="line">      cb()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　到这里我们实现了一个简单的订阅-发布器，所以我们需要对<code>current.route</code>做数据劫持。一旦<code>current.route</code>更新，我们可以及时的更新当前页面：</p>
<p>  // 响应式数据劫持<br>  <code>observer(this.current)</code></p>
<p>  // 对 current.route 对象进行依赖收集，变化时通过 render 来更新<br>  <code>new Watcher(this.current, &#39;route&#39;, this.render.bind(this))</code><br>恩….到这里，我们似乎已经完成了一个简单的响应式数据更新。其实render也就是动态的为页面指定区域渲染对应内容，这里只做一个简化版的render:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">render</span></span>() &#123;</span><br><span class="line">  <span class="built_in">let</span> i</span><br><span class="line">  <span class="keyword">if</span> ((i = this.history.current) &amp;&amp; (i = i.route) &amp;&amp; (i = i.component)) &#123;</span><br><span class="line">    document.getElementById(this.container).innerHTML = i</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h6 id="hash-和-history"><a href="#hash-和-history" class="headerlink" title="hash 和 history"></a>hash 和 history</h6><p>　　接下来是hash和history模式的实现，这里我们可以沿用vue-router的思想，建立不同的处理模型便可。来看一下我实现的核心代码：<br><code>this.history = this.mode === &#39;history&#39; ? new HTML5History(this) : new HashHistory(this)</code><br>当页面变化时，我们只需要监听hashchange和popstate事件，做路由转换transitionTo:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">  /**</span><br><span class="line">   * 路由转换</span><br><span class="line">   * @param target 目标路径</span><br><span class="line">   * @param cb 成功后的回调</span><br><span class="line">   */</span><br><span class="line">  transitionTo(target, cb) &#123;</span><br><span class="line">    // 通过对比传入的 routes 获取匹配到的 targetRoute 对象</span><br><span class="line">    const targetRoute = match(target, this.router.routes)</span><br><span class="line">    this.confirmTransition(targetRoute, () =&gt; &#123;</span><br><span class="line">      // 这里会触发视图更新</span><br><span class="line">      this.current.route = targetRoute</span><br><span class="line">      this.current.name = targetRoute.name</span><br><span class="line">      this.current.path = targetRoute.path</span><br><span class="line">      this.current.query = targetRoute.query || getQuery()</span><br><span class="line">      this.current.fullPath = getFullPath(this.current)</span><br><span class="line">      cb &amp;&amp; cb()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * 确认跳转</span><br><span class="line">   * @param route</span><br><span class="line">   * @param cb</span><br><span class="line">   */</span><br><span class="line">  confirmTransition (route, cb) &#123;</span><br><span class="line">    // 钩子函数执行队列</span><br><span class="line">    <span class="built_in">let</span> queue = [].concat(</span><br><span class="line">      this.router.beforeEach,</span><br><span class="line">      this.current.route.beforeLeave,</span><br><span class="line">      route.beforeEnter,</span><br><span class="line">      route.afterEnter</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    // 通过 step 调度执行</span><br><span class="line">    <span class="built_in">let</span> i = -1</span><br><span class="line">    const step = () =&gt; &#123;</span><br><span class="line">      i ++</span><br><span class="line">      <span class="keyword">if</span> (i &gt; queue.length) &#123;</span><br><span class="line">        cb()</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (queue[i]) &#123;</span><br><span class="line">        queue[i](step)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        step()</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    step(i)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　这样我们一方面通过<code>this.current.route = targetRoute</code>达到了对之前劫持数据的更新，来达到视图更新。另一方面我们又通过任务队列的调度，实现了基本的钩子函数<code>beforeEach、beforeLeave、beforeEnter、afterEnter</code>。<br>到这里其实也就差不多了，接下来我们顺带着实现几个API吧：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 跳转，添加历史记录</span><br><span class="line"> * @param location </span><br><span class="line"> * @example this.push(&#123;name: <span class="string">'home'</span>&#125;)</span><br><span class="line"> * @example this.push(<span class="string">'/'</span>)</span><br><span class="line"> */</span><br><span class="line">push (location) &#123;</span><br><span class="line">  const targetRoute = match(location, this.router.routes)</span><br><span class="line"></span><br><span class="line">  this.transitionTo(targetRoute, () =&gt; &#123;</span><br><span class="line">    changeUrl(this.router.base, this.current.fullPath)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 跳转，添加历史记录</span><br><span class="line"> * @param location</span><br><span class="line"> * @example this.replaceState(&#123;name: <span class="string">'home'</span>&#125;)</span><br><span class="line"> * @example this.replaceState(<span class="string">'/'</span>)</span><br><span class="line"> */</span><br><span class="line">replaceState(location) &#123;</span><br><span class="line">  const targetRoute = match(location, this.router.routes)</span><br><span class="line"></span><br><span class="line">  this.transitionTo(targetRoute, () =&gt; &#123;</span><br><span class="line">    changeUrl(this.router.base, this.current.fullPath, <span class="literal">true</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">go (n) &#123;</span><br><span class="line">  window.history.go(n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> changeUrl(path, replace) &#123;</span><br><span class="line">  const href = window.location.href</span><br><span class="line">  const i = href.indexOf(<span class="string">'#'</span>)</span><br><span class="line">  const base = i &gt;= 0 ? href.slice(0, i) : href</span><br><span class="line">  <span class="keyword">if</span> (replace) &#123;</span><br><span class="line">    window.history.replaceState(&#123;&#125;, <span class="string">''</span>, `<span class="variable">$&#123;base&#125;</span><span class="comment">#/$&#123;path&#125;`)</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    window.history.pushState(&#123;&#125;, <span class="string">''</span>, `<span class="variable">$&#123;base&#125;</span><span class="comment">#/$&#123;path&#125;`)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>到这里也就基本上结束了</p>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Vue/">Vue</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/09/29/H5/微信小程序和H5区别/" data-tooltip="微信小程序和H5区别" aria-label="上一篇: 微信小程序和H5区别">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/09/25/JavaScript/Vue图片懒加载原理及实现/" data-tooltip="Vue图片懒加载原理及实现" aria-label="下一篇: Vue图片懒加载原理及实现">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/" title="分享到 Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/" title="分享到 Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/" title="分享到 Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#gitment">
                         <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="gitment"></div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 LittleStar. All Rights Reserved.
    </span>
		<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
		<br/>
		<i class="fas fa-chart-area"></i>
		<span class="post-count">字数统计：139.5k</span>
</footer>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("10/10/2018 17:38:00");//在此处修改你的建站时间
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/09/29/H5/微信小程序和H5区别/" data-tooltip="微信小程序和H5区别" aria-label="上一篇: 微信小程序和H5区别">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/09/25/JavaScript/Vue图片懒加载原理及实现/" data-tooltip="Vue图片懒加载原理及实现" aria-label="下一篇: Vue图片懒加载原理及实现">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/" title="分享到 Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/" title="分享到 Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/" title="分享到 Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#gitment">
                         <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="5">
    <i id="btn-close-shareoptions" class="fa fa-times"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/">
                    <i class="fab fa-facebook" aria-hidden="true"></i><span>分享到 Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/">
                    <i class="fab fa-twitter" aria-hidden="true"></i><span>分享到 Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/">
                    <i class="fab fa-google-plus" aria-hidden="true"></i><span>分享到 Google+</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/user-photo/user.jpg" alt="作者的图片"/>
        
            <h4 id="about-card-name">LittleStar</h4>
        
            <div id="about-card-bio"><p>纵豆蔻词工，青楼好梦，难赋深情</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>程序员</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                China
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">没有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/JavaScript/前端本地储存/">
                            <h3 class="media-heading">前端本地储存</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h3 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h3><p>本地存储主要有以下几种，<code>cookie</code>，<code>localStorage</code>和<code>sessionStorage</code>，<code>WebSql</code>和<code>IndexDB</code>主要用在前端有大容量存储需求的页面上，例如，在线编辑浏览器或者网页邮箱。他们都可以将数据存储在浏览器，应该根据不同的场景进行使用。本文主要讲前三个。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/跨域的方法/跨域的方法/">
                            <h3 class="media-heading">跨域的方法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/CSS3/CSS3模块化/">
                            <h3 class="media-heading">CSS模块化</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/CSS3/渐进增强和优雅降级/">
                            <h3 class="media-heading">渐进增强和优雅降级</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/JavaScript/bind和call/">
                            <h3 class="media-heading">bind、apply和call的区别</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc --></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/CSS3/清除浮动/">
                            <h3 class="media-heading">清除浮动</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<p>转载：<a href="https://segmentfault.com/a/1190000004865198" target="_blank" rel="noopener">CSS-清除浮动</a></p>
<h4 id="为什么要清除浮动"><a href="#为什么要清除浮动" class="headerlink" title="为什么要清除浮动"></a>为什么要清除浮动</h4><p>　　浮动的元素是<code>脱离文档标准流</code>的，如果我们不清楚浮动，那么就会造成<code>父元素高度塌陷</code>，<code>影响页面布局</code>。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/H5/语义化标签/">
                            <h3 class="media-heading">语义化标签</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h4 id="H5中关于语义化的标签"><a href="#H5中关于语义化的标签" class="headerlink" title="H5中关于语义化的标签"></a>H5中关于语义化的标签</h4><h5 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h5><p>　　语义化是指根据内容的结构化（<code>内容语义化</code>），选择合适的标签（<code>代码语义化</code>），便于开发者阅读和写出更优雅的代码的同时，让浏览器的爬虫和机器很好的解析。</p>
<h5 id="为什么要语义化"><a href="#为什么要语义化" class="headerlink" title="为什么要语义化"></a>为什么要语义化</h5><p>　　1. 有利于SEO，有助于爬虫抓取更多的有效信息，爬虫是依赖于标签来确定上下文和各个关键字的权重。<br>　　2. 语义化的HTML在没有CSS的情况下也能呈现较好的内容结构与代码结构<br>　　3. 方便其他设备解析（如移动设备、盲人阅读器等）<br>　　4. 比div标签有更加丰富的含义，便于团队开发和维护</p>
<h5 id="关于语义化的标签有哪些"><a href="#关于语义化的标签有哪些" class="headerlink" title="关于语义化的标签有哪些"></a>关于语义化的标签有哪些</h5><p><code>title</code> 简短、描述性、唯一（提升搜索引擎排名）<br><code>header</code> 页眉通常包括网站标志、主导航、全站链接以及搜索框。<br><code>section</code> 具有相似主题的一组内容，比如网站的主页可以分成介绍、新闻条目、联系信息等条块。<br></p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/HTTP/get和post请求/">
                            <h3 class="media-heading">GET和POST请求</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h5 id="关于HTTP协议"><a href="#关于HTTP协议" class="headerlink" title="关于HTTP协议"></a>关于HTTP协议</h5><p>　　HTTP（即超文本传输协议）是现代网络中最常见和常用的协议之一，设计它的目的是保证客户机和服务器之间的通信。<br>　　HTTP 的工作方式是客户机与服务器之间的 “请求-应答” 协议。<br>　　在HTTP中，与服务器交互的方法，最常用的有4种：即Put（增）、Delete（删）、Post（改）、Get（查）。<br>get是获取数据，post是修改数据。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/JavaScript/冒泡和捕获/">
                            <h3 class="media-heading">冒泡和捕获</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc --></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://yoursite.com/2018/10/10/HTTP/常见的状态响应码/">
                            <h3 class="media-heading">常用的状态响应码</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018年10月10日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- 设置目录 -->
<!-- toc -->
<h3 id="状态码大类"><a href="#状态码大类" class="headerlink" title="状态码大类"></a>状态码大类</h3><table>
<thead>
<tr>
<th style="text-align:left">状态码</th>
<th style="text-align:right">说明</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1XX</td>
<td style="text-align:right"><strong>响应中</strong>——表示请求已经接受，继续处理</td>
<td style="text-align:center">消息：一般是告诉<strong>客户端请求已经收到了</strong>，正在处理，别急</td>
</tr>
<tr>
<td style="text-align:left">2XX</td>
<td style="text-align:right"><strong>成功</strong>——表示请求已经被成功接收、理解、接受。</td>
<td style="text-align:center"><strong> 处理成功</strong>：一般表示请求收悉、我明白你要的、请求已受理、已经处理完成等信息</td>
</tr>
<tr>
<td style="text-align:left">3XX</td>
<td style="text-align:right"><strong> 重定向</strong>——要完成请求必须进行更进一步的操作</td>
<td style="text-align:center">重定向到其它地方：它让客户端再发起一个请求以完成整个处理</td>
</tr>
<tr>
<td style="text-align:left">4XX</td>
<td style="text-align:right"><strong>客户端错误</strong>——请求有语法错误或请求无法实现</td>
<td style="text-align:center">处理发生错误，责任在客户端：如客户端的请求一个不存在的资源，客户端未被授权，禁止访问等。</td>
</tr>
<tr>
<td style="text-align:left">5XX</td>
<td style="text-align:right"><strong> 服务器端错误</strong>——服务器未能实现合法的请求。</td>
<td style="text-align:center">处理发生错误，责任在服务端：如服务端抛出异常，路由出错，HTTP版本不支持等</td>
</tr>
</tbody>
</table>
<blockquote>
<p>HTTP响应状态码有很多，但是实际经常使用的大概只有14个。<br></p></blockquote></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="没有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 94 篇文章
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-vufjrm3fmbuttogo1hxuu0w9w0sesk5iyysjuguc2hdhufot9szxg8twijry.min.js"></script>
<!--SCRIPTS END-->

    
        <script type="text/javascript">
            (function() {
                function render() {
                    new Gitment({
                        id: 'http://yoursite.com/2019/09/27/Vue/vue-router使用及实现原理/',
                        owner: 'alittlelittlestar',
                        repo: 'alittlelittlestar.github.io',
                        oauth: {
                            client_id: '87f258443d550d64eaaa',
                            client_secret: '49270712544e561ed30982cdc22b5cc35c180e31',
                        }
                    }).render('gitment');
                }
                var gc = document.createElement('script');
                gc.type = 'text/javascript';
                gc.src = '//imsun.github.io/gitment/dist/gitment.browser.js';
                gc.charset = 'UTF-8';
                gc.onload = render;
                gc.async = true;
                document.querySelector('body').appendChild(gc);
                var gcs = document.createElement('link');
                gcs.href = '//imsun.github.io/gitment/style/default.css';
                gcs.type = 'text/css';
                gcs.rel = 'stylesheet';
                gcs.media = 'screen,print';
                document.querySelector('head').appendChild(gcs);
            })();
	    </script>
    



    </body>
</html>
